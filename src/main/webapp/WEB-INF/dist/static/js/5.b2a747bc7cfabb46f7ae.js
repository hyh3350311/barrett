webpackJsonp([5],{k7gD:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.el-button--mini{\n  padding: 3px 8px;\n  border: none;\n}\n",""])},lqQZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("woOf"),i=a.n(o),r=a("F+jZ"),s={data:function(){return{validateFlag:!1,userName:sessionStorage.getItem("name"),editRoleId:[],token:sessionStorage.getItem("TOKEN"),roleList:"",users:[],total:0,page:1,pageSize:10,msg:"",msgVisible:!1,listLoading:!1,pwdLoading:!1,pwdFormVisible:!1,pwdForm:{passWord:"",userId:""},editFormVisible:!1,editLoading:!1,editFormRules:{userName:[{required:!0,message:"请输入账号",trigger:"blur"}],nickName:[{required:!0,message:"请输入姓名",trigger:"blur"}],passWord:[{required:!0,message:"请输入密码",trigger:"blur"}],passWordAgain:[{required:!0,message:"请输入确认密码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1\d{10}$/,message:"电话必须以1开头的11位数字",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}]},editForm:{userName:"",nickName:"",passWord:"",userId:"",roleId:"",passWordAgain:"",companyCode:"0",sex:-1,phone:"",email:""},addFormVisible:!1,addLoading:!1,addFormRules:{userName:[{required:!0,message:"请输入账号",trigger:"blur"}],nickName:[{required:!0,message:"请输入姓名",trigger:"blur"}],passWord:[{required:!0,message:"请输入密码",trigger:"blur"}],roleId1:[{type:"array",required:!0,message:"请选择角色",trigger:"change"}],passWordAgain:[{required:!0,message:"请输入确认密码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1\d{10}$/,message:"电话必须以1开头的11位数字",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}]},addForm:{userName:"",nickName:"",passWord:"",roleId:"",roleId1:[],passWordAgain:"",companyCode:"0",sex:-1,phone:"",email:""}}},mounted:function(){this.getUsers(),this.getRole()},methods:{formatSex:function(e,t){return 1==e.sex?"男":0==e.sex?"女":"未知"},handleCurrentChange:function(e){this.page=e,this.getUsers()},getRole:function(){var e=this;this.$ajax({method:"post",headers:{TOKEN:this.token},url:"/role/list"}).then(function(t){"0000"==t.data.key?e.roleList=t.data.ext:(e.msgVisible=!0,e.msg="获取角色列表失败")}).catch(function(t){Object(r.a)(t,e)})},getUsers:function(){var e=this;this.listLoading=!0,this.$ajax({method:"post",headers:{TOKEN:this.token},url:"/manageruser/list?curPage="+this.page+"&pageSize="+this.pageSize+"&_=1512282435226"}).then(function(t){e.total=t.data.totalCount,"0000"==t.data.key?(e.users=t.data.dataList,e.listLoading=!1):(e.msgVisible=!0,e.msg=t.data.msg)}).catch(function(t){Object(r.a)(t,e)})},handleDel:function(e,t){var a=this,o=this;this.$confirm("确认删除该记录吗?","提示",{type:"danger"}).then(function(){var e={userId:t.id};console.log(e),a.$ajax({method:"post",headers:{TOKEN:a.token},params:e,url:"/manageruser/delete"}).then(function(e){if("0000"==e.data.key){sessionStorage.getItem("name")==t.userName&&o.$router.push("/login"),o.getUsers()}else o.msgVisible=!0,o.msg=e.data.msg}).catch(function(e){Object(r.a)(e,o)})}).catch(function(){})},pwdModal:function(e,t){console.log(t),this.pwdFormVisible=!0,this.pwdForm.userId=t.id},updatePwd:function(){this.pwdLoading=!0;var e=this;e.$ajax({method:"post",headers:{TOKEN:this.token},params:this.pwdForm,url:"/manageruser/updatePassWord"}).then(function(t){e.pwdLoading=!1,e.msgVisible=!0,e.msg=t.data.msg,"0000"==t.data.key?(e.getUsers(),e.pwdForm.passWord="",e.pwdFormVisible=!1):(e.msgVisible=!0,e.msg=t.data.msg)}).catch(function(t){Object(r.a)(t,e),e.pwdLoading=!1})},handleEdit:function(e,t){if(console.log(t),this.editRoleId=[],this.editFormVisible=!0,this.editForm=i()({},t),this.editForm.roles)for(var a=this.editForm.roles.split(","),o=0,r=a.length;o<r;o++)this.editRoleId.push(parseInt(a[o]));else this.editRoleId=[];console.log(this.editRoleId)},editSubmit:function(){var e=this,t=this;this.$refs.editForm.validate(function(a){a&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0,e.editForm.userId=e.editForm.id,e.editForm.roleId=e.editRoleId.join(",");var a=i()({},e.editForm);e.$ajax({method:"post",headers:{TOKEN:e.token},params:a,url:"/manageruser/update"}).then(function(e){t.editLoading=!1,"0000"==e.data.key?(t.editFormVisible=!1,t.getUsers()):(t.msgVisible=!0,t.msg=e.data.msg)}).catch(function(e){t.editLoading=!1,Object(r.a)(e,t)})}).catch(function(){})})},handleAdd:function(){this.addForm.roleId1=[],this.addForm.sex="",this.addFormVisible=!0,this.addForm.companyCode="0",this.validateFlag&&this.$refs.addForm.resetFields()},addSubmit:function(){var e=this;this.addForm.roleId=this.addForm.roleId1.join(",");var t=this;this.token=sessionStorage.getItem("TOKEN"),this.$refs.addForm.validate(function(a){if(a){if(t.validateFlag=!1,e.addForm.passWord!=e.addForm.passWordAgain)return t.msgVisible=!0,t.msg="两次密码不一致请重新输入",!1;e.addLoading=!0;var o=i()({},e.addForm);t.$ajax({method:"post",headers:{TOKEN:e.token},params:o,url:"/manageruser/add"}).then(function(e){t.validateFlag=!0,"0000"==e.data.key?(t.getUsers(),t.addLoading=!1,t.addFormVisible=!1):(t.addLoading=!1,t.msgVisible=!0,t.msg=e.data.msg)}).catch(function(e){Object(r.a)(e,t),t.addLoading=!1})}else t.validateFlag=!0})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px","text-align":"left"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.users,"highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"userName",label:"账号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickName",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",formatter:e.formatSex}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.pwdModal(t.$index,t.row)}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),"admin"!=t.row.userName?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.handleDel(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"prev, pager, next","page-size":e.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:e.pwdFormVisible,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(t){e.pwdFormVisible=t}}},[a("el-form",{attrs:{model:e.pwdForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"密码",prop:"passWord"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.pwdForm.passWord,callback:function(t){e.$set(e.pwdForm,"passWord",t)},expression:"pwdForm.passWord"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.pwdFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.pwdLoading},nativeOn:{click:function(t){e.updatePwd(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"用户编辑",visible:e.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px",rules:e.editFormRules}},[a("el-form-item",{attrs:{label:"账号",prop:"userName"}},[a("el-input",{attrs:{disabled:"","auto-complete":"off"},model:{value:e.editForm.userName,callback:function(t){e.$set(e.editForm,"userName",t)},expression:"editForm.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"nickName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.nickName,callback:function(t){e.$set(e.editForm,"nickName",t)},expression:"editForm.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{type:"text"},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-radio-group",{model:{value:e.editForm.sex,callback:function(t){e.$set(e.editForm,"sex",t)},expression:"editForm.sex"}},[a("el-radio",{staticClass:"radio",attrs:{label:"1"}},[e._v("男")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"0"}},[e._v("女")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户角色"}},[a("el-checkbox-group",{model:{value:e.editRoleId,callback:function(t){e.editRoleId=t},expression:"editRoleId"}},e._l(e.roleList,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.roleName))])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.editLoading},nativeOn:{click:function(t){e.editSubmit(t)}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"账号",prop:"userName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.userName,callback:function(t){e.$set(e.addForm,"userName",t)},expression:"addForm.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"nickName"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.nickName,callback:function(t){e.$set(e.addForm,"nickName",t)},expression:"addForm.nickName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"passWord"}},[a("el-input",{attrs:{type:"passWord","auto-complete":"off"},model:{value:e.addForm.passWord,callback:function(t){e.$set(e.addForm,"passWord",t)},expression:"addForm.passWord"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"passWordAgain"}},[a("el-input",{attrs:{type:"passWord","auto-complete":"off"},model:{value:e.addForm.passWordAgain,callback:function(t){e.$set(e.addForm,"passWordAgain",t)},expression:"addForm.passWordAgain"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{type:"text"},model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-radio-group",{model:{value:e.addForm.sex,callback:function(t){e.$set(e.addForm,"sex",t)},expression:"addForm.sex"}},[a("el-radio",{staticClass:"radio",attrs:{label:"1"}},[e._v("男")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"0"}},[e._v("女")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户角色",prop:"roleId1"}},[a("el-checkbox-group",{model:{value:e.addForm.roleId1,callback:function(t){e.$set(e.addForm,"roleId1",t)},expression:"addForm.roleId1"}},e._l(e.roleList,function(t){return a("el-checkbox",{key:t.id,attrs:{name:"roleId",label:t.id}},[e._v(e._s(t.roleName))])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){e.addSubmit()}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.msgVisible,width:"30%"},on:{"update:visible":function(t){e.msgVisible=t}}},[a("span",[e._v(e._s(e.msg))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.msgVisible=!1}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]},d=a("VU/8")(s,l,!1,function(e){a("x2BS")},null,null);t.default=d.exports},x2BS:function(e,t,a){var o=a("k7gD");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("50ec4c2e",o,!0)}});